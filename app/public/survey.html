<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Star Wars - Express</title>
  <!-- Latest compiled and minified CSS & JS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
  <script src="https://code.jquery.com/jquery.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
 
  
  
</head>

<body>

<div class="container">
  <div class="jumbotron">
    <h1>Take our Friend Finding survey</h1>
    <h3>A place for lonley people to be lonley together</h3>
    <a href="/home">
      <button class="btn btn-default">Home</button>
    </a>
  </div>

  <div class="form-group">
      <label for="usr">Name:</label>
      <input type="text" class="form-control" id="name">
    </div>
    <div class="form-group">
      <label for="pwd">Photo Link</label>
      <input type="text" class="form-control" id="photo">
    </div>

</div>

  <div class="row">
  <div class="container">
      <div class="form-group">
          <label for="questionOne">Question 1:</label>
          <div>What is your favorite number?</div>
          <div class="col-md-4">
          <select class="form-control" id="questionOne" >
            <option>1</option>
            <option>2</option>
            <option>3</option>
            <option>4</option>
            <option>5</option>
          </select>
          </div>
        </div>
  </div>
</div>

<div class="row">
  <div class="container">
      <div class="form-group">
          <label for="questionOne">Question 2:</label>
          <div>I like cats</div>
          <div class="col-md-4">
          <select class="form-control" id="questionTwo" >
            <option>1</option>
            <option>2</option>
            <option>3</option>
            <option>4</option>
            <option>5</option>
          </select>
          </div>
        </div>
  </div>
</div>

<div class="row">
  <div class="container">
      <div class="form-group">
          <label for="questionOne">Question 3:</label>
          <div>I like dogs</div>
          <div class="col-md-4">
          <select class="form-control" id="questionThree" >
            <option>1</option>
            <option>2</option>
            <option>3</option>
            <option>4</option>
            <option>5</option>
          </select>
          </div>
        </div>
  </div>
</div>

<div class="row">
  <div class="container">
      <div class="form-group">
          <label for="questionOne">Question 4:</label>
          <div>Rick and morty is the greatest show ever.</div>
          <div class="col-md-4">
          <select class="form-control" id="questionFour" >
            <option>1</option>
            <option>2</option>
            <option>3</option>
            <option>4</option>
            <option>5</option>
          </select>
          </div>
        </div>
  </div>
</div>

<div class="row">
  <div class="container">
      <div class="form-group">
          <label for="questionOne">Question 5:</label>
          <div>Donald Trump is a dangerous boob.</div>
          <div class="col-md-4">
          <select class="form-control" id="questionFive" >
            <option>1</option>
            <option>2</option>
            <option>3</option>
            <option>4</option>
            <option>5</option>
          </select>
          </div>
        </div>
  </div>
</div>

<div class="row">
    <div class="container">
        <div class="form-group">
            <label for="questionOne">Question 6:</label>
            <div>Inception is dumb and dosen't make any sense. (So are most Nolan movies...think about it)</div>
            <div class="col-md-4">
            <select class="form-control" id="questionSix" >
              <option>1</option>
              <option>2</option>
              <option>3</option>
              <option>4</option>
              <option>5</option>
            </select>
            </div>
          </div>
    </div>
  </div>

<div class="row">
<div class="container">
  <div class="form-group">
      <label for="questionOne">Question 7:</label>
      <div>Mustached men are most hansome.</div>
      <div class="col-md-4">
      <select class="form-control" id="questionSeven" >
        <option>1</option>
        <option>2</option>
        <option>3</option>
        <option>4</option>
        <option>5</option>
      </select>
      </div>
    </div>
</div>
</div>

<div class="row">
<div class="container">
    <div class="form-group">
        <label for="questionOne">Question 8:</label>
        <div>Game of thrones is really good this season.</div>
        <div class="col-md-4">
        <select class="form-control" id="questionEight" >
          <option>1</option>
          <option>2</option>
          <option>3</option>
          <option>4</option>
          <option>5</option>
        </select>
        </div>
      </div>
</div>
</div>

<div class="row">
  <div class="container">
      <div class="form-group">
          <label for="questionOne">Question 9:</label>
          <div>The Goonies does not hold up and is overrated. It only seems good through the lense of your childhood. Back to the future, however is a cenima masterpiece.</div>
          <div class="col-md-4">
          <select class="form-control" id="questionNine" >
            <option>1</option>
            <option>2</option>
            <option>3</option>
            <option>4</option>
            <option>5</option>
          </select>
          </div>
        </div>
  </div>
</div>

<div class="row">
    <div class="container">
        <div class="form-group">
            <label for="questionOne">Question 10</label>
            <div>I would never date someone who listens to Coldplay.</div>
            <div class="col-md-4">
            <select class="form-control" id="questionTen" >
              <option>1</option>
              <option>2</option>
              <option>3</option>
              <option>4</option>
              <option>5</option>
            </select>
            </div>
          </div>
    </div>
  </div>

  <div class="container">
  <button type="button" class="btn btn-primary" id ="submitBtn" style= "margin: 20px; width: 100%;">Submit Survey</button>
  </div>


<!-- Modal -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Your New Friend</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <h3 id="friendName"></h3>
        <div><img id="friendPhoto"></div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>


</div>


<script>

  $('#submitBtn').on('click', postSurveyData);




function postSurveyData(){
  var values = Array.from($(".form-control").find(':selected')).map(function(item){
   return $(item).val();
  });

  var newFriend = {
    name: $('#name').val().trim(),
    photo: $('#photo').val().trim(),
    scores: values
  }

  $.post("/api/friends", newFriend,
    
  function(data) {
    if(data){
      console.log(data);
    }
    });
  displayBestMatch();
  }



  function displayBestMatch(){
    var currentURL = window.location.origin;

    $.ajax({ url: currentURL + "/api/match", method: "GET" })
        .done(function(matchData) {
          

          var currentMatch = matchData.slice(-1)[0]
          console.log(currentMatch);

          $('#friendName').html(currentMatch.name);
          $('#friendPhoto').attr('src', currentMatch.photo);
          $('#myModal').modal('show');

          
  });
  }

</script>



</body>